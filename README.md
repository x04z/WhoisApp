# 🔎 検索大臣 - Whois & IP Intelligence Tool -

`検索大臣` は、IPアドレスやドメインから、所有者情報（Whois）、地理的位置、ISP属性、および潜在的なIoT露出リスクを一括解析する実務特化型のインフラ調査ツールです。

## 💻 動作モードについて (重要)

本ツールは実行環境によってセキュリティポリシーとパフォーマンスが変化します。

| モード | 実行環境 | 推奨用途 | 特徴 |
| --- | --- | --- | --- |
| **🏠 Local Private版** | ローカルPC / 社内サーバー | **実務・大量処理** | 共有IPの制限を受けず、機密データ（顧客ログ等）も安全に処理可能。 |
| **☁️ Public Cloud版** | Streamlit Cloud等 | 手軽な単発検索 | サーバーが共有環境のため、APIのレートリミット（保留）が発生しやすい。 |

---

## 🚀 クイックスタート (Local版)

### 1. 必要なライブラリのインストール

```bash
pip install streamlit pandas requests streamlit-option-menu altair openpyxl

```

### 2. アプリの起動

```bash
streamlit run xxxxx.py

```

---

## ⚙️ 主な機能と設定

### 1. 表示モード

* **標準モード**: ターゲットを1行ずつ詳細に表示。
* **集約モード (IPv4 Group)**: 同じISP・国で連続するIPアドレスを1行に集約し、全体像を把握。
* **簡易モード (APIなし)**: API通信を行わず、調査用リンク（VirusTotal等）の生成のみを実行。

### 2. 詳細オプション

* **🔍 高精度モード (RDAP併用)**: `ip-api.com` の情報に加え、公式レジストリ(RDAP)へ直接照会。運用者だけでなく法的保有組織の特定を支援。
* **💀 IoTリスク検知 (InternetDB)**: Shodanのポートスキャン履歴を参照し、危険なポート開放を自動検知。APIキー不要。
* **🔑 Pro Mode (ipinfo.io)**: `ipinfo.io` のAPIキーを適用。VPN/Proxy判定の精度が劇的に向上し、API制限の回避策として有効。

---

## ⚠️ 判定アイコンとリスク定義

解析結果に表示される警告の意味は以下の通りです：

* **🧅 [Tor Node]**: 匿名化ネットワークTorの出口ノード。
* **💀 [IoT Risk]**: 外部からアクセス可能な危険なポートを検知。
* **🍏 [iCloud Private Relay]**: Appleデバイスのプライバシー保護通信。
* **☁️ [Hosting/VPN/Proxy]**: データセンターや商用VPN経由。Botや匿名化ツールの可能性。

### 🚨 監視対象ポートのリスク詳細

* **⚠️ 23 (Telnet) / 21 (FTP)**: 暗号化なし。踏み台化の危険性が極めて高い。
* **🔥 1080 / 3128 / 8080 (Proxy)**: 攻撃の中継点として悪用される典型的なポート。
* **💀 7547 (CWMP)**: ルーター乗っ取りの兆候。深刻な脆弱性の可能性。
* **🤖 5555 / 5554 (ADB)**: Androidデバイスが認証なしで外部操作可能な状態。
* **📡 1900 (UPnP)**: ネットワーク内の機器探索用プロトコルの露出。

---

## 📝 FAQ

* **Q. 検索が途中で止まる、または遅い。**
* A. 無料版APIのレートリミット（分間45回）が原因です。ツールは自動待機しますが、スムーズな解析には「Local版」の利用、または「Pro Mode (IPinfo)」の適用を検討してください。


* **Q. ISP名とRDAPの名前が違うのですが？**
* A. 「運用者」と「法的保有組織（土地の持ち主）」の違いです。


* **Q. 発信者情報開示をどちらに請求すればいいでしょうか？**
* A. 契約者情報を保持しているのは、運用者である「ISP名」の組織です。


* **Q. IoT Risk判定は確定ですか？**
* A. いいえ。Shodanの過去のスキャン履歴に基づく指標であり、リアルタイムの確定情報ではありません。
